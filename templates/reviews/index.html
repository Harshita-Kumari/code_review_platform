{% extends "reviews/base.html" %}
{% block content %}
<section class="card form-card">
  <h2>Get an AI Code Review</h2>

  <form method="post" enctype="multipart/form-data" id="review-form">
    {% csrf_token %}
    <div class="form-row">
      {{ form.title.label_tag }}<br>
      {{ form.title }}
    </div>

    <div class="form-row">
      {{ form.language.label_tag }}<br>
      {{ form.language }}
    </div>

    <div class="form-row">
      {{ form.code.label_tag }}<br>

      <div id="editor-wrapper">
        <!-- Monaco editor renders here -->
        <div id="editor" class="code-editor"></div>

        <!-- Django textarea (fallback) -->
        {{ form.code }}
      </div>

      <p class="hint small">
        If the editor doesnâ€™t load, you can still type directly in the textarea.
      </p>
    </div>

    <div class="form-row">
      {{ form.upload.label_tag }}<br>
      {{ form.upload }}
      <div id="upload-info" class="hint"></div>
    </div>

    <div class="form-row">
      {{ form.repo_url.label_tag }}<br>
      {{ form.repo_url }}
      <p class="hint small">
        Example: <code>https://github.com/username/repo</code> or
        <code>https://github.com/username/repo/tree/branch</code>.
        Leave empty if you are uploading a file/ZIP.
      </p>
    </div>

    <div class="form-actions">
      <button type="submit" id="submit-btn" class="btn-primary">
        <span id="btn-text">Review code</span>
        <span id="btn-spinner" class="spinner" style="display:none"></span>
      </button>
    </div>
  </form>

  <p class="hint">
    Tip: paste code, upload a single .py/.js/.java/.txt file,
    upload a <strong>.zip project folder</strong>, or just paste a
    <strong>GitHub repository URL</strong>. Max {{ max_file_mb }} MB.
  </p>
</section>
{% endblock %}
